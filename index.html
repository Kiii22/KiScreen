<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>CryptoVerse Pro</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
:root{
--bg:#050508;--card:#0f0f16;--text:#e2e8f0;--dim:#94a3b8;
--primary:#3b82f6;--green:#10b981;--red:#ef4444;
}
.light{
--bg:#f8fafc;--card:#ffffff;--text:#020617;--dim:#475569;
}
body{margin:0;background:var(--bg);color:var(--text);font-family:system-ui}
header{padding:1rem;border-bottom:1px solid #333;display:flex;justify-content:space-between}
button{background:var(--card);color:var(--text);border:1px solid #333;padding:.5rem 1rem;cursor:pointer}
.container{padding:1rem}
.grid{display:grid;grid-template-columns:250px 1fr;gap:1rem}
.asset{padding:.5rem;border-bottom:1px solid #333;cursor:pointer}
.asset:hover{background:#222}
.card{background:var(--card);padding:1rem;border-radius:10px}
.up{color:var(--green)} .down{color:var(--red)}
</style>
</head>

<body>
<header>
<strong>ðŸš€ CryptoVerse Pro</strong>
<div>
<button onclick="toggleMode()">ðŸŒ— Mode</button>
<button onclick="switchType('crypto')">Crypto</button>
<button onclick="switchType('etf')">ETF</button>
</div>
</header>

<div class="container grid">
<div class="card" id="list"></div>

<div class="card">
<h2 id="title">Bitcoin</h2>
<h1 id="price">$0</h1>
<canvas id="chart" height="120"></canvas>

<h3>Teknikal</h3>
<p>RSI: <strong id="rsi">--</strong></p>
<p>EMA 20: <strong id="ema20">--</strong></p>
<p>EMA 50: <strong id="ema50">--</strong></p>
</div>
</div>

<script>
const API="https://api.coingecko.com/api/v3";
const CRYPTO=["bitcoin","ethereum","solana"];
const ETF={
spy:{name:"SPY",price:520},
ibit:{name:"IBIT",price:40}
};

let type="crypto",chart;

function toggleMode(){document.body.classList.toggle("light")}

function switchType(t){type=t;loadList()}

async function loadList(){
const el=document.getElementById("list");el.innerHTML="";
if(type==="crypto"){
const r=await fetch(`${API}/coins/markets?vs_currency=usd&ids=${CRYPTO.join(",")}`);
const d=await r.json();
d.forEach(c=>{
const div=document.createElement("div");
div.className="asset";
div.innerText=c.name;
div.onclick=()=>loadCrypto(c.id);
el.appendChild(div);
});
}else{
Object.keys(ETF).forEach(k=>{
const div=document.createElement("div");
div.className="asset";
div.innerText=ETF[k].name;
div.onclick=()=>loadETF(k);
el.appendChild(div);
});
}
}

async function loadCrypto(id){
const r=await fetch(`${API}/coins/${id}/market_chart?vs_currency=usd&days=30`);
const d=await r.json();
drawChart(d.prices.map(p=>p[1]));
calcIndicators(d.prices.map(p=>p[1]));
document.getElementById("title").innerText=id.toUpperCase();
document.getElementById("price").innerText="$"+d.prices.at(-1)[1].toFixed(2);
}

function loadETF(id){
let p=ETF[id].price,prices=[];
for(let i=0;i<30;i++){p*=1+(Math.random()-.48)*.02;prices.push(p)}
drawChart(prices);
document.getElementById("title").innerText=ETF[id].name;
document.getElementById("price").innerText="$"+p.toFixed(2);
document.getElementById("rsi").innerText="N/A";
document.getElementById("ema20").innerText="N/A";
document.getElementById("ema50").innerText="N/A";
}

function drawChart(data){
if(chart)chart.destroy();
chart=new Chart(document.getElementById("chart"),{
type:"line",
data:{labels:data.map((_,i)=>i),datasets:[{data,borderWidth:2,tension:.4}]},
options:{plugins:{legend:{display:false}},scales:{x:{display:false}}}
});
}

function EMA(data,period){
const k=2/(period+1);let ema=data[0];
data.forEach(v=>ema=v*k+ema*(1-k));
return ema;
}

function RSI(data,period=14){
let gains=0,losses=0;
for(let i=1;i<=period;i++){
let diff=data[i]-data[i-1];
if(diff>=0)gains+=diff;else losses-=diff;
}
let rs=gains/losses;
return (100-(100/(1+rs))).toFixed(2);
}

function calcIndicators(data){
document.getElementById("ema20").innerText=EMA(data.slice(-20),20).toFixed(2);
document.getElementById("ema50").innerText=EMA(data.slice(-50),50).toFixed(2);
document.getElementById("rsi").innerText=RSI(data);
}

loadList();loadCrypto("bitcoin");
</script>
</body>
</html>
